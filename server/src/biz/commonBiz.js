// Generated by CoffeeScript 1.12.4
(function() {
  var db, isLogined, setUserinfo;

  db = require('./../libs/db');

  setUserinfo = function(req, res, next) {
    var token;
    token = req.headers['x-token'];
    return db.users.findOne({
      token: token,
      expiredTime: {
        $gt: Date.now()
      }
    }, function(err, user) {
      if (!err) {
        req.userinfo = user;
      }
      return next();
    });
  };

  isLogined = function(req, res, next) {
    if (!req.userinfo) {
      res.status(401);
      res.send('未授权');
      return;
    }
    return next();
  };

  module.exports = {
    setUserinfo: setUserinfo,
    isLogined: isLogined
  };

}).call(this);

//# sourceMappingURL=commonBiz.js.map
